import{_ as G,i as H,aD as K,r as d,A as I,$ as O,e as J,g as L,o as M,H as n,m as Q,f as a,w as t,ar as S,l as W,h as s,a9 as h,aA as X,j as Y,au as v,k as p,q as g,aE as Z,F as ee}from"./index-BwFLAmkK.js";import{_ as ae}from"./passing-CouDye6I.js";import{u as le,c as se,a as f,d as i,V as te}from"./vee-validate-I791GmZT.js";import{v as re}from"./index-Dcj7LDNL.js";import{a as u,V as b}from"./VRow-Br5g1yRP.js";import{V as B}from"./VSelect-C4PjwKxS.js";import"./_commonjsHelpers-gnU0ypJ3.js";import"./VList-CkbSh5-e.js";const oe={class:"pt-8 bg-light"},ue={key:0,class:"lottie-overlay"},ne={__name:"profile",setup(ie){const m=H();K("fileAgent"),d([]),d([]);const{handleSubmit:E,isSubmitting:z,setValues:N}=le({validationSchema:se({name:f().required("球場名稱必填").min(1,"球場名稱不能為空"),gender:f().required("性別必填"),email:f().required("電子郵件必填").test("isEmail","請輸入有效的電子郵件地址",r=>re.isEmail(r)),skillLevel:f().required("球技程度必填")})}),V=i("name"),_=i("gender"),y=i("email"),w=i("skillLevel"),k=i("password"),x=i("line_uid"),P=i("google_uid"),q=d(""),D=d(null),U=d(null),A=d(null),R=()=>{A.value.click()},C=async()=>{try{const{data:r}=await I.profile(),e=r.user;N({name:e.name,gender:e.gender,email:e.email,skillLevel:e.skillLevel,password:e.password,line_uid:e.line_uid,google_uid:e.google_uid}),q.value=e.avatar,D.value=null,U.value=null}catch(r){console.error("會員資料取得失敗:",r),m({text:"無法載入會員資料，請重新整理或稍後再試",snackbarProps:{color:"red"}})}},j=E(async r=>{var e,o;try{await I.updateProfile(r),m({text:"球員資料編輯成功！",snackbarProps:{color:"green"}}),await C()}catch(l){console.error(l),m({text:((o=(e=l==null?void 0:l.response)==null?void 0:e.data)==null?void 0:o.message)||"球員資料編輯失敗，請稍後再試！",snackbarProps:{color:"red"}})}}),T=async r=>{const e=r.target.files[0];if(e){const o=new FileReader;o.onload=l=>{D.value=l.target.result},o.readAsDataURL(e),await $(e)}},$=async r=>{var e,o;try{const l=new FormData;l.append("avatar",r);const{data:F}=await I.updateProfile(l);F.user&&F.user.avatar&&(q.value=F.user.avatar,D.value=null,U.value=null),m({text:"照片更新成功！",snackbarProps:{color:"green"}})}catch(l){console.error("照片上傳失敗:",l),m({text:((o=(e=l==null?void 0:l.response)==null?void 0:e.data)==null?void 0:o.message)||"照片更新失敗，請稍後再試！",snackbarProps:{color:"red"}})}},c={required:r=>!!r||"此欄位為必填."};return O(()=>{C()}),(r,e)=>{const o=J("v-icon-btn");return M(),L(ee,null,[n("div",oe,[a(b,{justify:"center"},{default:t(()=>[a(u,{cols:"12",md:"10"},{default:t(()=>[a(S,{class:"pa-16 rounded-lg card-memberPage"},{default:t(()=>[a(te,{onSubmit:W(s(j),["prevent"])},{default:t(()=>[n("div",null,[n("div",null,[e[7]||(e[7]=n("h1",{class:"font-weight-bold text-h4"},"球員資料",-1)),a(h,{thickness:2,opacity:"20",class:"mt-5"})])]),a(h,{class:"my-4"}),a(b,{class:"align-start"},{default:t(()=>[a(u,{cols:"12",md:"2",class:"mt-16 ml-14"},{default:t(()=>[a(X,{size:"100"},{default:t(()=>[a(Y,{src:ae,class:"avatar-img",cover:""})]),_:1}),n("input",{type:"file",ref_key:"fileInput",ref:A,onChange:T,style:{display:"none"},accept:"image/*"},null,544),a(o,{icon:"mdi-pencil",class:"mt-15 ml-n7 btn",onClick:R,rounded:"circle"})]),_:1}),a(u,{cols:"12",sm:"9",md:"9"},{default:t(()=>[a(S,{class:"pa-6 rounded-lg card-memberPage"},{default:t(()=>[e[9]||(e[9]=n("h3",{class:"font-weight-bold mb-4",style:{"font-size":"1.3rem"}},"一般資訊",-1)),a(b,null,{default:t(()=>[a(u,{cols:"12",sm:"6"},{default:t(()=>[a(v,{label:"姓名",modelValue:s(V).value.value,"onUpdate:modelValue":e[0]||(e[0]=l=>s(V).value.value=l),"error-messages":s(V).errorMessage.value,variant:"outlined","hide-details":"",rules:[c.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1}),a(u,{cols:"12",sm:"6"},{default:t(()=>[a(B,{label:"性別",modelValue:s(_).value.value,"onUpdate:modelValue":e[1]||(e[1]=l=>s(_).value.value=l),"error-messages":s(_).errorMessage.value,variant:"outlined","hide-details":"",items:["女性","男性"],rules:[c.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1}),a(u,{cols:"12",sm:"6"},{default:t(()=>[a(v,{label:"Email",modelValue:s(y).value.value,"onUpdate:modelValue":e[2]||(e[2]=l=>s(y).value.value=l),"error-messages":s(y).errorMessage.value,variant:"outlined","hide-details":"",rules:[c.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1}),a(u,{cols:"12",sm:"6"},{default:t(()=>[a(B,{label:"球技程度",modelValue:s(w).value.value,"onUpdate:modelValue":e[3]||(e[3]=l=>s(w).value.value=l),"error-messages":s(w).errorMessage.value,variant:"outlined","hide-details":"",items:["S 體保生","A 一般生校隊","B 一般生系隊","C 排球初階","D 排球初心者"],rules:[c.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1}),a(p,{class:"mt-4 btn",type:"submit"},{default:t(()=>e[8]||(e[8]=[g("更新球員資料",-1)])),_:1,__:[8]})]),_:1,__:[9]}),a(S,{class:"pa-6 rounded-lg mt-8 card-memberPage"},{default:t(()=>[e[13]||(e[13]=n("h3",{class:"font-weight-bold mb-4",style:{"font-size":"1.3rem"}},"機密資訊",-1)),a(b,null,{default:t(()=>[a(u,{cols:"12",sm:"4"},{default:t(()=>[a(v,{label:"Password",type:"password",modelValue:s(k).value.value,"onUpdate:modelValue":e[4]||(e[4]=l=>s(k).value.value=l),"error-messages":s(k).errorMessage.value,variant:"outlined","hide-details":"",readonly:"",class:"neubrutalism"},null,8,["modelValue","error-messages"]),a(p,{class:"mt-4 btn",variant:"outlined",type:"submit",block:""},{default:t(()=>e[10]||(e[10]=[g("更改密碼",-1)])),_:1,__:[10]})]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(v,{label:"Line ID",modelValue:s(x).value.value,"onUpdate:modelValue":e[5]||(e[5]=l=>s(x).value.value=l),"error-messages":s(x).errorMessage.value,variant:"outlined","hide-details":"",readonly:"",class:"neubrutalism"},null,8,["modelValue","error-messages"]),a(p,{class:"mt-4 btn",type:"submit",variant:"outlined",block:""},{default:t(()=>e[11]||(e[11]=[g("更改 Line ID",-1)])),_:1,__:[11]})]),_:1}),a(u,{cols:"12",sm:"4"},{default:t(()=>[a(v,{label:"Google ID",modelValue:s(P).value.value,"onUpdate:modelValue":e[6]||(e[6]=l=>s(P).value.value=l),"error-messages":s(P).errorMessage.value,variant:"outlined","hide-details":"",readonly:"",class:"neubrutalism"},null,8,["modelValue","error-messages"]),a(p,{class:"mt-4 btn",type:"submit",variant:"outlined",block:""},{default:t(()=>e[12]||(e[12]=[g("更改 Google ID",-1)])),_:1,__:[12]})]),_:1})]),_:1})]),_:1,__:[13]})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1}),e[14]||(e[14]=n("div",{class:"bottom-decoration d-flex justify-end pr-8",style:{position:"fixed",bottom:"0",width:"100%","z-index":"-1"}},null,-1))]),s(z)?(M(),L("div",ue,[a(s(Z),{style:{height:"500px",width:"500px"},autoplay:"",loop:"",src:"https://lottie.host/4583ad3e-73e1-4f3a-83d5-048a1943aaa7/gPKIV1O45e.lottie"})])):Q("",!0)],64)}}},Ve=G(ne,[["__scopeId","data-v-1f1a9478"]]);export{Ve as default};
