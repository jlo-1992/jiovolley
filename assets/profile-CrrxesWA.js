import{_ as $,i as O,aE as H,r as d,c as J,f as L,o as Q,g as W,k as j,h as A,j as l,n as X,e as s,K as u,ar as U,s as Y,l as a,as as B,m as Z,av as m,q as g,x as f,aF as ee,F as le}from"./index-DaEO0Ukc.js";import{u as ae,c as se,a as V,d as i,V as te}from"./vee-validate-DYqlQZvt.js";import{v as re}from"./index-Dcj7LDNL.js";import{V as v,a as o}from"./VRow-CTXBQx_m.js";import{V as E}from"./VSelect-CK8m1lC0.js";import{V as oe}from"./VContainer-CRs3msxA.js";import"./_commonjsHelpers-gnU0ypJ3.js";import"./VList-Di5Z55Sr.js";const ue={class:"img-wrapper"},ie={class:"text-right"},ne={key:0,class:"lottie-overlay"},de={__name:"profile",setup(me){const _=O();H("fileAgent"),d([]),d([]);const{handleSubmit:h,isSubmitting:z,setValues:N}=ae({validationSchema:se({name:V().required("球場名稱必填").min(1,"球場名稱不能為空"),gender:V().required("性別必填"),email:V().required("電子郵件必填").test("isEmail","請輸入有效的電子郵件地址",r=>re.isEmail(r)),skillLevel:V().required("球技程度必填")})}),y=i("name"),w=i("gender"),k=i("email"),x=i("skillLevel"),q=i("password"),F=i("line_uid"),S=i("google_uid"),I=i("quote"),C=d(""),P=d(null),b=d(null),D=d(null),R=()=>{D.value.click()},T=J(()=>P.value||C.value||"@/assets/images/userProfile/ryujji.jpg"),M=async()=>{try{const{data:r}=await L.profile(),e=r.user;console.log(e._id),N({name:e.name,gender:e.gender,email:e.email,skillLevel:e.skillLevel,password:e.password,line_uid:e.line_uid,google_uid:e.google_uid,quote:e.quote}),C.value=e.avatar,P.value=null,b.value=null}catch(r){console.error("會員資料取得失敗:",r),_({text:"無法載入會員資料，請重新整理或稍後再試",snackbarProps:{color:"red"}})}},G=h(async r=>{var e,n;try{const t=new FormData;for(const c in r)c!=="password"&&c!=="line_uid"&&c!=="google_uid"&&t.append(c,r[c]);b.value&&t.append("avatar",b.value);const{data:ve}=await L.updateProfile(t);_({text:"球員資料編輯成功！",snackbarProps:{color:"green"}}),await M()}catch(t){console.error(t),_({text:((n=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:n.message)||"球員資料編輯失敗，請稍後再試！",snackbarProps:{color:"red"}})}}),K=r=>{const e=r.target.files[0];if(e){b.value=e;const n=new FileReader;n.onload=t=>{P.value=t.target.result},n.readAsDataURL(e)}},p={required:r=>!!r||"此欄位為必填."};return Q(()=>{M()}),(r,e)=>{const n=W("v-icon-btn");return A(),j(le,null,[l(oe,{class:"bg-dark"},{default:s(()=>[l(U,{class:"pa-16 mt-1 card-memberPage"},{default:s(()=>[l(te,{onSubmit:Y(a(G),["prevent"])},{default:s(()=>[u("div",null,[u("div",null,[e[8]||(e[8]=u("h1",{class:"font-weight-bold text-h4"},"球員資料",-1)),l(B,{thickness:2,opacity:"20",class:"mt-5"})])]),l(B,{class:"my-4"}),l(v,{justify:"center"},{default:s(()=>[l(o,{cols:"12",md:"12"},{default:s(()=>[l(U,{class:"pb-13 pt-8 pl-16 card-memberPage"},{default:s(()=>[e[11]||(e[11]=u("h3",{class:"font-weight-bold ml-n6",style:{"font-size":"1.3rem"}},"一般資訊",-1)),l(v,null,{default:s(()=>[l(o,{cols:"12",sm:"4"},{default:s(()=>[u("div",ue,[l(Z,{src:a(T),class:"avatar-img",cover:""},null,8,["src"]),u("input",{type:"file",ref_key:"fileInput",ref:D,onChange:K,style:{display:"none"},accept:"image/*"},null,544),l(n,{icon:"mdi-pencil",class:"btn btn-edit",onClick:R,rounded:"circle",size:"50"})])]),_:1}),l(o,{cols:"12",sm:"7"},{default:s(()=>[l(v,null,{default:s(()=>[l(o,{cols:"12",sm:"6",class:"mt-3"},{default:s(()=>[l(m,{label:"姓名",modelValue:a(y).value.value,"onUpdate:modelValue":e[0]||(e[0]=t=>a(y).value.value=t),"error-messages":a(y).errorMessage.value,variant:"outlined","hide-details":"",rules:[p.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1}),l(o,{cols:"12",sm:"6",class:"mt-3"},{default:s(()=>[l(E,{label:"性別",modelValue:a(w).value.value,"onUpdate:modelValue":e[1]||(e[1]=t=>a(w).value.value=t),"error-messages":a(w).errorMessage.value,variant:"outlined","hide-details":"",items:["女性","男性"],rules:[p.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1}),l(v,null,{default:s(()=>[l(o,{cols:"12",sm:"6"},{default:s(()=>[l(m,{label:"Email",modelValue:a(k).value.value,"onUpdate:modelValue":e[2]||(e[2]=t=>a(k).value.value=t),"error-messages":a(k).errorMessage.value,variant:"outlined","hide-details":"",rules:[p.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1}),l(o,{cols:"12",sm:"6"},{default:s(()=>[l(E,{label:"球技程度",modelValue:a(x).value.value,"onUpdate:modelValue":e[3]||(e[3]=t=>a(x).value.value=t),"error-messages":a(x).errorMessage.value,variant:"outlined","hide-details":"",items:["S 體保生","A 一般生校隊","B 一般生系隊","C 排球初階","D 排球初心者"],rules:[p.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1}),l(v,null,{default:s(()=>[l(o,{cols:"12",sm:"12"},{default:s(()=>[l(m,{label:"你的專屬球場勝利語",modelValue:a(I).value.value,"onUpdate:modelValue":e[4]||(e[4]=t=>a(I).value.value=t),"error-messages":a(I).errorMessage.value,variant:"outlined","hide-details":"",rules:[p.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1}),u("div",ie,[l(g,{class:"mt-4 btn mr-3",color:"white",type:"cancel"},{default:s(()=>e[9]||(e[9]=[f("取消更新",-1)])),_:1,__:[9]}),l(g,{class:"mt-4 btn",type:"submit"},{default:s(()=>e[10]||(e[10]=[f("確認更新",-1)])),_:1,__:[10]})])]),_:1})]),_:1})]),_:1,__:[11]}),l(U,{class:"pa-10 rounded-lg mt-8 card-memberPage"},{default:s(()=>[e[15]||(e[15]=u("h3",{class:"font-weight-bold mb-4",style:{"font-size":"1.3rem"}},"機密資訊",-1)),l(v,null,{default:s(()=>[l(o,{cols:"12",sm:"4"},{default:s(()=>[l(m,{label:"Password",type:"password",modelValue:a(q).value.value,"onUpdate:modelValue":e[5]||(e[5]=t=>a(q).value.value=t),"error-messages":a(q).errorMessage.value,variant:"outlined","hide-details":"",readonly:"",class:"neubrutalism"},null,8,["modelValue","error-messages"]),l(g,{class:"mt-6 btn",variant:"outlined",type:"submit",block:""},{default:s(()=>e[12]||(e[12]=[f("更改密碼",-1)])),_:1,__:[12]})]),_:1}),l(o,{cols:"12",sm:"4"},{default:s(()=>[l(m,{label:"Line ID",modelValue:a(F).value.value,"onUpdate:modelValue":e[6]||(e[6]=t=>a(F).value.value=t),"error-messages":a(F).errorMessage.value,variant:"outlined","hide-details":"",readonly:"",class:"neubrutalism"},null,8,["modelValue","error-messages"]),l(g,{class:"mt-6 btn",type:"submit",variant:"outlined",block:""},{default:s(()=>e[13]||(e[13]=[f("更改 Line ID",-1)])),_:1,__:[13]})]),_:1}),l(o,{cols:"12",sm:"4"},{default:s(()=>[l(m,{label:"Google ID",modelValue:a(S).value.value,"onUpdate:modelValue":e[7]||(e[7]=t=>a(S).value.value=t),"error-messages":a(S).errorMessage.value,variant:"outlined","hide-details":"",readonly:"",class:"neubrutalism"},null,8,["modelValue","error-messages"]),l(g,{class:"mt-6 btn",type:"submit",variant:"outlined",block:""},{default:s(()=>e[14]||(e[14]=[f("更改 Google ID",-1)])),_:1,__:[14]})]),_:1})]),_:1})]),_:1,__:[15]})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e[16]||(e[16]=u("div",{class:"bottom-decoration d-flex justify-end pr-8",style:{position:"fixed",bottom:"0",width:"100%","z-index":"-1"}},null,-1))]),_:1,__:[16]}),a(z)?(A(),j("div",ne,[l(a(ee),{style:{height:"500px",width:"500px"},autoplay:"",loop:"",src:"https://lottie.host/4583ad3e-73e1-4f3a-83d5-048a1943aaa7/gPKIV1O45e.lottie"})])):X("",!0)],64)}}},we=$(de,[["__scopeId","data-v-a3693316"]]);export{we as default};
