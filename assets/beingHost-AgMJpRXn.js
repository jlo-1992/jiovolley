import{s as E}from"./socialParticipantService-Cw5KBzem.js";import{s as B}from"./socialService-DgW3tfAB.js";import{_ as K,i as G,r as m,o as J,g as O,k as u,h as r,j as a,d as S,n as y,e as s,ar as p,K as e,as as P,x as v,F as g,v as D,y as n,q as U,at as w,au as F,az as I,m as W,aD as X,f as Y}from"./index-CRyPVaQa.js";import{d as Z}from"./dayjs.min-CFWPjdno.js";import{V as ee,a as te}from"./VRow-D0VY-hpW.js";import{V as T}from"./VTable-Ddrd-eYy.js";import{V as M}from"./VAlert-DhCTbefO.js";import{V as le}from"./VContainer-CGzTqyYM.js";import"./_commonjsHelpers-gnU0ypJ3.js";const ae={key:0},se={key:0},ne={__name:"beingHost",setup(oe){const Q=G(),q=m(!1);m([]);const k=m([]),b=m([]),_=m({open:!1,id:""}),d=m([]),h=m([]),V=m([]),H=async o=>{_.value.open=!0,_.value.id=o._id,await j(o)},N=()=>{_.value.open=!1,_.value.id=""},L=m(""),x=m({open:!1,id:""}),R=async o=>{x.value.open=!0,x.value.id=o._id,await A(o)},z=()=>{x.value.open=!1,x.value.id=""},A=async o=>{try{const t=o._id,{data:i}=await B.getQrCode(t);L.value=i.qrCodeDataUrl,console.log("qrCodeDataUrl",L.value)}catch(t){console.error("Qrcode 取得失敗:",t),Q({text:"無法載入 Qrcode，請重新整理或稍後再試",snackbarProps:{color:"red"}}),z()}},$=async()=>{q.value=!0;try{const{data:o}=await Y.profile(),t=o.user._id,{data:i}=await B.getAll({time:"upcoming"});i.success&&(k.value=(i.socials||[]).filter(c=>{var f;return((f=c.host)==null?void 0:f._id)===t})),console.log("即將到來的場次:",k.value);const{data:l}=await B.getAll({time:"past"});l.success&&(b.value=(l.socials||[]).filter(c=>{var f;return((f=c.host)==null?void 0:f._id)===t})),console.log("已過期的場次:",b.value)}catch(o){console.error("揪團紀錄取得失敗:",o),Q({text:"無法載入揪團紀錄，請重新整理或稍後再試",snackbarProps:{color:"red"}})}},j=async o=>{try{const t=o._id,{data:i}=await E.getParticipantsList(t);d.value=i.participantsList,h.value=d.value.filter(l=>l.user.gender==="female"),V.value=d.value.filter(l=>l.user.gender==="male"),console.log("femalePlayers",h.value),console.log("malePlayers",V.value)}catch(t){console.error("球員名單取得失敗:",t),Q({text:"無法載入球員名單，請重新整理或稍後再試",snackbarProps:{color:"red"}})}},C=o=>o?Z(o).format("HH:mm"):"";return J(()=>{$()}),(o,t)=>{const i=O("v-icon-btn");return r(),u(g,null,[a(le,{class:"bg-dark"},{default:s(()=>[a(p,{class:"mt-1 pa-16 card-memberPage"},{default:s(()=>[e("div",null,[t[2]||(t[2]=e("div",null,[e("h1",{class:"font-weight-bold text-h4"},"揪團紀錄")],-1)),a(P,{thickness:2,opacity:"20",class:"mt-5"})]),a(P,{class:"my-4"}),a(ee,{class:"mt-4 align-center"},{default:s(()=>[a(te,{cols:"12"},{default:s(()=>[a(p,{class:"pa-4 card-memberPage"},{default:s(()=>[t[7]||(t[7]=e("h2",{class:"mb-4 font-weight-bold",style:{"font-size":"1.3rem"}},"即將開打的場次",-1)),a(T,{height:"300px","fixed-header":"",striped:"even"},{default:s(()=>[k.value.length===0?(r(),S(M,{key:0,type:"info",class:"mt-4"},{default:s(()=>t[3]||(t[3]=[v(" 目前沒有您的揪團紀錄 ",-1)])),_:1,__:[3]})):y("",!0),t[6]||(t[6]=e("thead",null,[e("tr",null,[e("th",{class:"text-left"},"球場"),e("th",{class:"text-left"},"時段"),e("th",{class:"text-left"},"價格"),e("th",{class:"text-left"},"球員名單"),e("th",{class:"text-left"},"出席登入"),e("th",{class:"text-left"},"備註")])],-1)),e("tbody",null,[(r(!0),u(g,null,D(k.value,(l,c)=>(r(),u("tr",{key:c},[e("td",null,n(l.venue.name),1),e("td",null,n(C(l.startDateTime))+" - "+n(C(l.endDateTime)),1),e("td",null,n(l.fee),1),e("td",null,[a(U,{onClick:f=>H(l),class:"btn"},{default:s(()=>t[4]||(t[4]=[v("球員名單",-1)])),_:2,__:[4]},1032,["onClick"])]),e("td",null,[a(U,{class:"btn",onClick:f=>R(l)},{default:s(()=>t[5]||(t[5]=[v("QR Code",-1)])),_:2,__:[5]},1032,["onClick"])]),e("td",null,n(l.note),1)]))),128))])]),_:1,__:[6]})]),_:1,__:[7]}),a(p,{class:"pa-4 mt-8 card-memberPage"},{default:s(()=>[t[11]||(t[11]=e("h2",{class:"mb-4 font-weight-bold",style:{"font-size":"1.3rem"}},"已結束的場次",-1)),a(T,{height:"300px","fixed-header":"",striped:"even"},{default:s(()=>[b.value.length===0?(r(),S(M,{key:0,type:"info",class:"mt-4"},{default:s(()=>t[8]||(t[8]=[v(" 目前沒有您的揪團紀錄 ",-1)])),_:1,__:[8]})):y("",!0),t[10]||(t[10]=e("thead",null,[e("tr",null,[e("th",{class:"text-left"},"球場"),e("th",{class:"text-left"},"時段"),e("th",{class:"text-left"},"價格"),e("th",{class:"text-left"},"球員名單"),e("th",{class:"text-left"},"備註")])],-1)),e("tbody",null,[(r(!0),u(g,null,D(b.value,(l,c)=>{var f;return r(),u("tr",{key:c},[e("td",null,n(((f=l.venue)==null?void 0:f.name)||"未知場地"),1),e("td",null,n(C(l.startDateTime))+" - "+n(C(l.endDateTime)),1),e("td",null,n(l.fee),1),e("td",null,[a(U,{class:"btn",onClick:re=>H(l)},{default:s(()=>t[9]||(t[9]=[v("球員名單",-1)])),_:2,__:[9]},1032,["onClick"])]),e("td",null,n(l.note),1)])}),128))])]),_:1,__:[10]})]),_:1,__:[11]})]),_:1})]),_:1})]),_:1})]),_:1}),a(I,{modelValue:_.value.open,"onUpdate:modelValue":t[0]||(t[0]=l=>_.value.open=l),persistent:"",width:"800"},{default:s(()=>[a(p,{rounded:"lg",class:"card-dialog"},{default:s(()=>[a(w,{class:"text-center mt-3 page-title"},{default:s(()=>t[12]||(t[12]=[v("球員名單",-1)])),_:1,__:[12]}),a(i,{icon:"mdi-close",onClick:N,class:"btn btn-close"}),a(P,{thickness:"2",opacity:"20",color:"black",class:"mx-auto",width:"25%"}),a(F,null,{default:s(()=>[a(p,{class:"card-players"},{default:s(()=>[a(w,null,{default:s(()=>[t[13]||(t[13]=v("女性球員 ",-1)),d.value.length>0&&d.value[0].social?(r(),u(g,{key:0},[v("（需求人數："+n(d.value[0].social.demandFemalePlayers)+"/ 已報名人數："+n(d.value[0].social.currentFemalePlayers)+"）",1)],64)):y("",!0)]),_:1,__:[13]}),a(T,{height:"300px","fixed-header":"",striped:"even"},{default:s(()=>[t[15]||(t[15]=e("thead",null,[e("tr",null,[e("th",{class:"text-left"},"球員"),e("th",{class:"text-left"},"程度"),e("th",{class:"text-left"},"出席率"),e("th",{class:"text-left"},"狀態"),e("th",{class:"text-left"},"操作")])],-1)),e("tbody",null,[h.value.length===0?(r(),u("tr",ae,t[14]||(t[14]=[e("td",null,"目前還沒有球員報名喔，趕快揪人去~",-1)]))):(r(!0),u(g,{key:1},D(h.value,(l,c)=>(r(),u("tr",{key:c},[e("td",null,n(l.user.name),1),e("td",null,n(l.user.skillLevel),1),e("td",null,n(l.user.attendanceRate)+" ("+n(l.user.attendancePresent)+" / "+n(l.user.attendanceTotal)+") ",1),e("td",null,n(l.status),1),e("td",null,[a(i,{icon:"mdi-pencil"})])]))),128))])]),_:1,__:[15]})]),_:1}),a(p,{class:"mt-5 card-players"},{default:s(()=>[a(w,null,{default:s(()=>[d.value.length>0&&d.value[0].social?(r(),u(g,{key:0},[v(" 男性球員（需求人數："+n(d.value[0].social.demandMalePlayers)+"/ 已報名人數："+n(d.value[0].social.currentMalePlayers)+"）",1)],64)):y("",!0)]),_:1}),a(T,{height:"300px","fixed-header":"",striped:"even"},{default:s(()=>[t[17]||(t[17]=e("thead",null,[e("tr",null,[e("th",{class:"text-left"},"球員"),e("th",{class:"text-left"},"程度"),e("th",{class:"text-left"},"出席率"),e("th",{class:"text-left"},"狀態"),e("th",{class:"text-left"},"操作")])],-1)),e("tbody",null,[V.value.length===0?(r(),u("tr",se,t[16]||(t[16]=[e("td",{style:{"font-size":"1rem"}},"目前還沒有球員報名喔，趕快揪人去~",-1)]))):(r(!0),u(g,{key:1},D(V.value,(l,c)=>(r(),u("tr",{key:c},[e("td",null,n(l.user.name),1),e("td",null,n(l.user.skillLevel),1),e("td",null,n(l.user.attendanceRate)+"("+n(l.user.attendancePresent)+"/"+n(l.user.attendanceTotal)+") ",1),e("td",null,n(l.status),1),e("td",null,[a(i,{icon:"mdi-pencil"})])]))),128))])]),_:1,__:[17]})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(I,{modelValue:x.value.open,"onUpdate:modelValue":t[1]||(t[1]=l=>x.value.open=l),persistent:"",width:"500"},{default:s(()=>[a(p,{rounded:"lg",class:"card-dialog"},{default:s(()=>[a(w,{class:"text-center mt-3 page-title"},{default:s(()=>t[18]||(t[18]=[v("出席登入 Qrcode",-1)])),_:1,__:[18]}),a(i,{icon:"mdi-close",onClick:z,class:"btn btn-close"}),a(P,{thickness:"2",opacity:"20",color:"black",class:"mx-auto",width:"25%"}),a(F,null,{default:s(()=>[a(W,{src:L.value},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),q.value?(r(),S(X,{key:0,indeterminate:"",color:"primary"})):y("",!0)],64)}}},_e=K(ne,[["__scopeId","data-v-5bb9f189"]]);export{_e as default};
