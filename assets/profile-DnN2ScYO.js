import{_ as H,i as K,aD as O,r as d,A as I,$ as J,e as Q,g as L,o as h,H as n,m as W,f as l,w as t,ar as S,l as X,h as s,a9 as B,aA as Y,j as Z,au as m,k as p,q as g,aE as ee,F as le}from"./index-Dm7nCjjk.js";import{_ as ae}from"./passing-CouDye6I.js";import{u as se,c as te,a as f,d as i,V as re}from"./vee-validate-N_hm_IvK.js";import{v as oe}from"./index-Dcj7LDNL.js";import{a as o,V as b}from"./VRow-Dt6IMYhC.js";import{V as E}from"./VSelect-55ySGfJZ.js";import"./_commonjsHelpers-gnU0ypJ3.js";import"./VList-CFRBHqqf.js";const ue={class:"pt-8 bg-light"},ne={key:0,class:"lottie-overlay"},ie={__name:"profile",setup(de){const v=K();O("fileAgent"),d([]),d([]);const{handleSubmit:z,isSubmitting:N,setValues:R}=se({validationSchema:te({name:f().required("球場名稱必填").min(1,"球場名稱不能為空"),gender:f().required("性別必填"),email:f().required("電子郵件必填").test("isEmail","請輸入有效的電子郵件地址",r=>oe.isEmail(r)),skillLevel:f().required("球技程度必填")})}),V=i("name"),_=i("gender"),y=i("email"),w=i("skillLevel"),k=i("password"),x=i("line_uid"),q=i("google_uid"),P=i("quote"),U=d(""),D=d(null),M=d(null),A=d(null),j=()=>{A.value.click()},C=async()=>{try{const{data:r}=await I.profile(),e=r.user;console.log(e._id),R({name:e.name,gender:e.gender,email:e.email,skillLevel:e.skillLevel,password:e.password,line_uid:e.line_uid,google_uid:e.google_uid,quote:e.quote}),U.value=e.avatar,D.value=null,M.value=null}catch(r){console.error("會員資料取得失敗:",r),v({text:"無法載入會員資料，請重新整理或稍後再試",snackbarProps:{color:"red"}})}},T=z(async r=>{var e,u;try{await I.updateProfile(r),v({text:"球員資料編輯成功！",snackbarProps:{color:"green"}}),await C()}catch(a){console.error(a),v({text:((u=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:u.message)||"球員資料編輯失敗，請稍後再試！",snackbarProps:{color:"red"}})}}),$=async r=>{const e=r.target.files[0];if(e){const u=new FileReader;u.onload=a=>{D.value=a.target.result},u.readAsDataURL(e),await G(e)}},G=async r=>{var e,u;try{const a=new FormData;a.append("avatar",r);const{data:F}=await I.updateProfile(a);F.user&&F.user.avatar&&(U.value=F.user.avatar,D.value=null,M.value=null),v({text:"照片更新成功！",snackbarProps:{color:"green"}})}catch(a){console.error("照片上傳失敗:",a),v({text:((u=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:u.message)||"照片更新失敗，請稍後再試！",snackbarProps:{color:"red"}})}},c={required:r=>!!r||"此欄位為必填."};return J(()=>{C()}),(r,e)=>{const u=Q("v-icon-btn");return h(),L(le,null,[n("div",ue,[l(b,{justify:"center"},{default:t(()=>[l(o,{cols:"12",md:"10"},{default:t(()=>[l(S,{class:"pa-16 rounded-lg card-memberPage"},{default:t(()=>[l(re,{onSubmit:X(s(T),["prevent"])},{default:t(()=>[n("div",null,[n("div",null,[e[8]||(e[8]=n("h1",{class:"font-weight-bold text-h4"},"球員資料",-1)),l(B,{thickness:2,opacity:"20",class:"mt-5"})])]),l(B,{class:"my-4"}),l(b,null,{default:t(()=>[l(o,{cols:"12",md:"2",class:"mt-16 ml-14"},{default:t(()=>[l(Y,{size:"100"},{default:t(()=>[l(Z,{src:ae,class:"avatar-img",cover:""})]),_:1}),n("input",{type:"file",ref_key:"fileInput",ref:A,onChange:$,style:{display:"none"},accept:"image/*"},null,544),l(u,{icon:"mdi-pencil",class:"mt-15 ml-n7 btn",onClick:j,rounded:"circle"})]),_:1}),l(o,{cols:"12",sm:"9",md:"9"},{default:t(()=>[l(S,{class:"pa-6 rounded-lg card-memberPage"},{default:t(()=>[e[10]||(e[10]=n("h3",{class:"font-weight-bold mb-4",style:{"font-size":"1.3rem"}},"一般資訊",-1)),l(b,null,{default:t(()=>[l(o,{cols:"12",sm:"6"},{default:t(()=>[l(m,{label:"姓名",modelValue:s(V).value.value,"onUpdate:modelValue":e[0]||(e[0]=a=>s(V).value.value=a),"error-messages":s(V).errorMessage.value,variant:"outlined","hide-details":"",rules:[c.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1}),l(o,{cols:"12",sm:"6"},{default:t(()=>[l(E,{label:"性別",modelValue:s(_).value.value,"onUpdate:modelValue":e[1]||(e[1]=a=>s(_).value.value=a),"error-messages":s(_).errorMessage.value,variant:"outlined","hide-details":"",items:["女性","男性"],rules:[c.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1}),l(o,{cols:"12",sm:"6"},{default:t(()=>[l(m,{label:"Email",modelValue:s(y).value.value,"onUpdate:modelValue":e[2]||(e[2]=a=>s(y).value.value=a),"error-messages":s(y).errorMessage.value,variant:"outlined","hide-details":"",rules:[c.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1}),l(o,{cols:"12",sm:"6"},{default:t(()=>[l(E,{label:"球技程度",modelValue:s(w).value.value,"onUpdate:modelValue":e[3]||(e[3]=a=>s(w).value.value=a),"error-messages":s(w).errorMessage.value,variant:"outlined","hide-details":"",items:["S 體保生","A 一般生校隊","B 一般生系隊","C 排球初階","D 排球初心者"],rules:[c.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1}),l(o,{cols:"12"},{default:t(()=>[l(m,{label:"你的專屬球場勝利語",modelValue:s(P).value.value,"onUpdate:modelValue":e[4]||(e[4]=a=>s(P).value.value=a),"error-messages":s(P).errorMessage.value,variant:"outlined","hide-details":"",rules:[c.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1}),l(p,{class:"mt-4 btn",type:"submit"},{default:t(()=>e[9]||(e[9]=[g("更新球員資料",-1)])),_:1,__:[9]})]),_:1,__:[10]}),l(S,{class:"pa-6 rounded-lg mt-8 card-memberPage"},{default:t(()=>[e[14]||(e[14]=n("h3",{class:"font-weight-bold mb-4",style:{"font-size":"1.3rem"}},"機密資訊",-1)),l(b,null,{default:t(()=>[l(o,{cols:"12",sm:"4"},{default:t(()=>[l(m,{label:"Password",type:"password",modelValue:s(k).value.value,"onUpdate:modelValue":e[5]||(e[5]=a=>s(k).value.value=a),"error-messages":s(k).errorMessage.value,variant:"outlined","hide-details":"",readonly:"",class:"neubrutalism"},null,8,["modelValue","error-messages"]),l(p,{class:"mt-4 btn",variant:"outlined",type:"submit",block:""},{default:t(()=>e[11]||(e[11]=[g("更改密碼",-1)])),_:1,__:[11]})]),_:1}),l(o,{cols:"12",sm:"4"},{default:t(()=>[l(m,{label:"Line ID",modelValue:s(x).value.value,"onUpdate:modelValue":e[6]||(e[6]=a=>s(x).value.value=a),"error-messages":s(x).errorMessage.value,variant:"outlined","hide-details":"",readonly:"",class:"neubrutalism"},null,8,["modelValue","error-messages"]),l(p,{class:"mt-4 btn",type:"submit",variant:"outlined",block:""},{default:t(()=>e[12]||(e[12]=[g("更改 Line ID",-1)])),_:1,__:[12]})]),_:1}),l(o,{cols:"12",sm:"4"},{default:t(()=>[l(m,{label:"Google ID",modelValue:s(q).value.value,"onUpdate:modelValue":e[7]||(e[7]=a=>s(q).value.value=a),"error-messages":s(q).errorMessage.value,variant:"outlined","hide-details":"",readonly:"",class:"neubrutalism"},null,8,["modelValue","error-messages"]),l(p,{class:"mt-4 btn",type:"submit",variant:"outlined",block:""},{default:t(()=>e[13]||(e[13]=[g("更改 Google ID",-1)])),_:1,__:[13]})]),_:1})]),_:1})]),_:1,__:[14]})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1}),e[15]||(e[15]=n("div",{class:"bottom-decoration d-flex justify-end pr-8",style:{position:"fixed",bottom:"0",width:"100%","z-index":"-1"}},null,-1))]),s(N)?(h(),L("div",ne,[l(s(ee),{style:{height:"500px",width:"500px"},autoplay:"",loop:"",src:"https://lottie.host/4583ad3e-73e1-4f3a-83d5-048a1943aaa7/gPKIV1O45e.lottie"})])):W("",!0)],64)}}},_e=H(ie,[["__scopeId","data-v-2018d0d7"]]);export{_e as default};
