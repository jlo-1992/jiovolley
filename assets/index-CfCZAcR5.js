import{S as ee,a as te}from"./navigation-BqagVsDO.js";import{N as ae}from"./navigation-TJIzCish.js";import{_ as le,a as se,r as d,R as oe,a3 as ne,o as re,aA as ie,g as D,d as b,h as p,e,j as t,ar as g,aB as T,q as w,a7 as C,B as k,x as _,av as de,p as U,K as o,m as E,y as c,k as I,F as z,v as S,at as me,au as ce,aC as ue,z as fe,C as ve,n as pe,l as H,f as ge}from"./index-DaEO0Ukc.js";import{v as _e}from"./venueService-Bh9F_nMF.js";import{s as ye}from"./socialService-IPBDMb6Q.js";import{s as be}from"./socialParticipantService-vQJv6GQy.js";import{d as A}from"./dayjs.min-CFWPjdno.js";import{r as he}from"./zh-tw-vtWARsfI.js";import{V as h,a as i}from"./VRow-CTXBQx_m.js";import{V as xe}from"./VList-Di5Z55Sr.js";import{V as Ve}from"./VContainer-CRs3msxA.js";import"./_commonjsHelpers-gnU0ypJ3.js";const we={class:"d-flex justify-space-between"},ke={class:"font-weight-bold mt-n1 mb-1",style:{"font-size":"2rem"}},Pe={class:"font-weight-bold mt-10",style:{"font-size":"1.3rem"}},De={class:"font-weight-bold"},Te={class:"d-flex justify-space-between"},Ce={style:{"font-size":"1.5rem"},class:"text-center"},Ie={class:"venueName"},ze={__name:"index",setup(Se){A.extend(he),A.locale("zh-tw");const q=[ae];se();let P=d(""),N=d(0),j=d(0);const x=d([]),$=d("@/assets/images/gabi hitting.jpg.jpg"),G=oe("Transactions"),K=ne(()=>G.value==="Transactions"?[{id:1,title:"出席",value:90,color:"#ffd000"},{id:2,title:"缺席",value:10,color:"#f1f1f1",pattern:"url(#pattern-0)"}]:[{id:1,title:"出席",value:90,color:"#353D42"},{id:2,title:"缺席",value:10,color:"#f1f1f1"}]),J=d([{title:j,text:"打過的 play"},{title:N,text:"揪過的 play"},{title:P,text:"加入揪排咖"},{title:P,text:"加入揪排咖"}]),Q=d(),B=d([new Date]),M=d([]),F=["blue","indigo","deep-purple","cyan","green","orange","grey darken-1"],L=["Meeting","Holiday","PTO","Travel","Event","Birthday","Conference","Party"],n=d({});function W({start:s,end:a}){const m=[],u=s,f=a,l=(f.getTime()-u.getTime())/864e5,r=y(l,l+20);for(let V=0;V<r;V++){const v=y(0,3)===0,O=y(u.getTime(),f.getTime()),R=new Date(O-O%9e5),Y=y(2,v?288:8)*9e5,Z=new Date(R.getTime()+Y);m.push({title:L[y(0,L.length-1)],start:R,end:Z,color:F[y(0,F.length-1)],allDay:!v})}M.value=m}function y(s,a){return Math.floor((a-s+1)*Math.random())+s}const X=async()=>{try{const{data:s}=await ge.profile();if(!s||!s.user){console.log("API 回傳資料格式不正確或無使用者資料",s);return}n.value=s.user,P.value=A(n.value.createdAt).fromNow();const{data:a}=await ye.getAll();if(a&&a.socials){const f=a.socials.filter(l=>{var r;return((r=l.host)==null?void 0:r._id)===n.value._id});N.value=f.length}else console.log("API 回傳活動資料格式不正確",a);const{data:m}=await be.getMyParticipations();m&&m.myParticipations?j.value=m.myParticipations.length:console.log("API 回傳參與活動資料格式不正確",m);const{data:u}=await _e.getAvailable();if(u&&u.venues&&n.value.favoriteVenues){const f=new Set(n.value.favoriteVenues);x.value=u.venues.filter(l=>f.has(l._id)).map(l=>{const r=l.images&&l.images.length>0?l.images[0]:$.value;return{...l,imageUrl:r}})}}catch(s){console.error("使用者資料取得失敗:",s)}};return re(()=>{X();const s=ie();W({start:s.startOfDay(s.startOfMonth(new Date)),end:s.endOfDay(s.endOfMonth(new Date))})}),(s,a)=>{const m=D("v-calendar"),u=D("v-pie"),f=D("router-link");return p(),b(Ve,{class:"bg-dark"},{default:e(()=>[t(g,{class:"bg-light pt-10 mt-1 pb-5",style:{border:"2px solid black"}},{default:e(()=>[t(h,null,{default:e(()=>[t(i,{cols:"4",md:"6"},{default:e(()=>[t(T,{text:"回首頁",location:"bottom"},{activator:e(({props:l})=>[t(w,C({variant:"outlined",class:"ml-7 btn-hover",rounded:"0",to:"/",size:"40"},l),{default:e(()=>[t(k,null,{default:e(()=>a[1]||(a[1]=[_("mdi-home",-1)])),_:1,__:[1]})]),_:2},1040)]),_:1})]),_:1}),t(i,{cols:"8",md:"6",class:"d-flex"},{default:e(()=>[t(de,{"prepend-inner-icon":"mdi-magnify",density:"compact",placeholder:"請輸入關鍵字","hide-details":"",style:{"background-color":"#f1f1f1",border:"2px solid black"},class:"mr-md-10 mr-3"}),t(w,{class:"mr-md-2 mr-1 btn-hover",variant:"outlined",rounded:"0",to:"/",size:"40"},{default:e(()=>[t(k,null,{default:e(()=>a[2]||(a[2]=[_("mdi-bell",-1)])),_:1,__:[2]})]),_:1}),t(U,{rounded:"0",image:n.value.avatar,style:{border:"2px solid black"},class:"mr-7 btn-hover"},null,8,["image"])]),_:1})]),_:1}),t(h,null,{default:e(()=>[t(i,{cols:"11",md:"7"},{default:e(()=>[a[3]||(a[3]=o("h1",{class:"card-title mb-3 ml-7"},"球員檔案 Player Information",-1)),t(g,{class:"pa-5 card-memberPage mb-5 ml-7",color:"#fdd000"},{default:e(()=>[t(h,null,{default:e(()=>[t(i,{cols:"12",md:"4"},{default:e(()=>[t(E,{style:{border:"2px solid black"},src:n.value.avatar,height:"320",width:"250",class:"mt-1 mx-auto mx-md-0",cover:""},null,8,["src"])]),_:1}),t(i,{cols:"12 ",md:"8",class:"ml-md-n5"},{default:e(()=>[t(i,{cols:"12"},{default:e(()=>[o("div",we,[o("h1",ke,c(n.value.name),1),t(T,{text:"編輯球員檔案",location:"bottom"},{activator:e(({props:l})=>[t(w,C(l,{to:"/member/profile",rounded:"0",size:"35",variant:"outlined",class:"btn-hover mt-1"}),{default:e(()=>[t(k,{icon:"mdi-pencil"})]),_:2},1040)]),_:1})]),o("h3",null,c(n.value.gender)+"．"+c(n.value.skillLevel)+"．",1),o("h3",null,c(n.value.email),1),t(h,{class:"mt-3"},{default:e(()=>[(p(!0),I(z,null,S(J.value,(l,r)=>(p(),b(i,{cols:"6",md:"3",key:r},{default:e(()=>[t(g,{class:"card-border text-center",rounded:"0",width:"130"},{default:e(()=>[t(me,{class:"font-weight-bold",style:{"font-size":"1.5rem"}},{default:e(()=>[_(c(l.title),1)]),_:2},1024),t(ce,null,{default:e(()=>[_(c(l.text),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),o("div",null,[o("h1",Pe,c(n.value.quote),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1,__:[3]}),t(i,{cols:"11",md:"5"},{default:e(()=>[a[4]||(a[4]=o("h1",{class:"card-title mt-1 mb-2 ml-7 ml-md-0"},"排球行事曆 Events Calender",-1)),t(g,{class:"pa-4 card-memberPage mr-md-7 ml-7 ml-md-0",height:"368",style:{"overflow-y":"scroll"}},{default:e(()=>[t(h,{class:"fill-height"},{default:e(()=>[t(i,null,{default:e(()=>[t(ue,{height:"350"},{default:e(()=>[t(m,{ref_key:"calendar",ref:Q,modelValue:B.value,"onUpdate:modelValue":a[0]||(a[0]=l=>B.value=l),events:M.value,color:"#353D42",type:"month"},null,8,["modelValue","events"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1,__:[4]}),t(i,{cols:"12",md:"4"},{default:e(()=>[a[6]||(a[6]=o("div",{class:"card-title mb-2 ml-7 mt-7 mt-md-0"},"出席統計 Presence Rate",-1)),t(g,{class:"card-memberPage mr-10 mr-md-7 ml-7 mb-7",height:"225"},{default:e(()=>[t(u,{items:K.value,legend:{position:s.$vuetify.display.mdAndUp?"right":"bottom"},tooltip:{subtitleFormat:"[value]%"},class:"justify-center mt-5","inner-cut":"70","item-key":"id",rounded:"2",size:"180",animation:"","hide-slice":"",reveal:""},{center:e(()=>a[5]||(a[5]=[o("div",{class:"text-center"},[o("div",{class:"card-title text-h5"},"出席率"),o("div",{class:"opacity-70 text-h4 mt-1 mb-n1"},"90%")],-1)])),legend:e(({items:l,toggle:r,isActive:V})=>[t(xe,{class:"py-0 mb-n5 mb-md-0 bg-transparent",density:"compact",width:"150"},{default:e(()=>[(p(!0),I(z,null,S(l,v=>(p(),b(fe,{key:v.key,class:ve(["my-1",{"opacity-40":!V(v)}]),title:v.title,rounded:"xl",link:""},{prepend:e(()=>[t(U,{color:v.color,size:16},null,8,["color"])]),append:e(()=>[o("div",De,c(v.value)+"%",1)]),_:2},1032,["class","title"]))),128))]),_:2},1024)]),_:1},8,["items","legend"])]),_:1})]),_:1,__:[6]}),t(i,{cols:"10",md:"8",class:"ml-md-n7 ml-7 mr-7 mb-8 mb-md-0"},{default:e(()=>[o("div",Te,[a[8]||(a[8]=o("h1",{class:"card-title mb-2"},"收藏的球場 Favorite Courts",-1)),t(T,{text:"編輯收藏",location:"bottom"},{activator:e(({props:l})=>[t(w,C({class:"mr-md-2 mr-1 mt-1 btn-hover",variant:"outlined",rounded:"0",to:"/member/favorites",size:"35"},l),{default:e(()=>[t(k,null,{default:e(()=>a[7]||(a[7]=[_("mdi-pencil",-1)])),_:1,__:[7]})]),_:2},1040)]),_:1})]),!x.value||x.value.length===0?(p(),b(g,{key:0,height:"225",class:"card-memberPage d-flex align-center justify-center"},{default:e(()=>[o("h1",Ce,[a[10]||(a[10]=_(" 你還沒有收藏任何球場喔~快到 ",-1)),t(f,{to:"/venueList"},{default:e(()=>a[9]||(a[9]=[o("span",{style:{"text-decoration":"underline"}},"球場列表",-1)])),_:1,__:[9]}),a[11]||(a[11]=_(" 搜尋喜歡的球場吧！ ",-1))])]),_:1})):pe("",!0),t(H(ee),{slidesPerView:"4",navigation:!0,modules:q,"space-between":220,class:"mySwiper"},{default:e(()=>[(p(!0),I(z,null,S(x.value,(l,r)=>(p(),b(H(te),{key:r},{default:e(()=>[t(g,{class:"card-memberPage card-favoriteVenues",width:"300",height:"220",to:`/venueSingle/${l._id}`},{default:e(()=>[t(E,{src:l.imageUrl,class:"fill-height img-favoriteVenues",cover:""},null,8,["src"]),o("h2",Ie,c(l.name),1)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},qe=le(ze,[["__scopeId","data-v-583644bb"]]);export{qe as default};
