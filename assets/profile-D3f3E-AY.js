import{_ as H,i as K,aE as O,r as d,A as S,$ as J,e as Q,g as A,o as h,f as l,m as W,w as s,H as n,aq as U,l as X,h as t,ar as B,j as Y,au as m,k as f,q as g,aF as Z,F as ee}from"./index-C2Ki1pi2.js";import{_ as le}from"./ryujji-Dg__2X3a.js";import{u as ae,c as se,a as b,d as i,V as te}from"./vee-validate-CL3FzwEA.js";import{v as re}from"./index-Dcj7LDNL.js";import{V as v,a as o}from"./VRow-Dk5fHTbR.js";import{V as E}from"./VSelect-Cqm4FKVJ.js";import{V as oe}from"./VContainer-Du8D55aO.js";import"./_commonjsHelpers-gnU0ypJ3.js";import"./VList-BdzMwNZM.js";const ue={class:"img-wrapper"},ne={class:"text-right"},ie={key:0,class:"lottie-overlay"},de={__name:"profile",setup(me){const c=K();O("fileAgent"),d([]),d([]);const{handleSubmit:z,isSubmitting:N,setValues:R}=ae({validationSchema:se({name:b().required("球場名稱必填").min(1,"球場名稱不能為空"),gender:b().required("性別必填"),email:b().required("電子郵件必填").test("isEmail","請輸入有效的電子郵件地址",r=>re.isEmail(r)),skillLevel:b().required("球技程度必填")})}),V=i("name"),_=i("gender"),y=i("email"),w=i("skillLevel"),k=i("password"),x=i("line_uid"),q=i("google_uid"),P=i("quote"),C=d(""),F=d(null),D=d(null),M=d(null),j=()=>{M.value.click()},L=async()=>{try{const{data:r}=await S.profile(),e=r.user;console.log(e._id),R({name:e.name,gender:e.gender,email:e.email,skillLevel:e.skillLevel,password:e.password,line_uid:e.line_uid,google_uid:e.google_uid,quote:e.quote}),C.value=e.avatar,F.value=null,D.value=null}catch(r){console.error("會員資料取得失敗:",r),c({text:"無法載入會員資料，請重新整理或稍後再試",snackbarProps:{color:"red"}})}},T=z(async r=>{var e,u;try{await S.updateProfile(r),c({text:"球員資料編輯成功！",snackbarProps:{color:"green"}}),await L()}catch(a){console.error(a),c({text:((u=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:u.message)||"球員資料編輯失敗，請稍後再試！",snackbarProps:{color:"red"}})}}),$=async r=>{const e=r.target.files[0];if(e){const u=new FileReader;u.onload=a=>{F.value=a.target.result},u.readAsDataURL(e),await G(e)}},G=async r=>{var e,u;try{const a=new FormData;a.append("avatar",r);const{data:I}=await S.updateProfile(a);I.user&&I.user.avatar&&(C.value=I.user.avatar,F.value=null,D.value=null),c({text:"照片更新成功！",snackbarProps:{color:"green"}})}catch(a){console.error("照片上傳失敗:",a),c({text:((u=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:u.message)||"照片更新失敗，請稍後再試！",snackbarProps:{color:"red"}})}},p={required:r=>!!r||"此欄位為必填."};return J(()=>{L()}),(r,e)=>{const u=Q("v-icon-btn");return h(),A(ee,null,[l(oe,{class:"bg-dark"},{default:s(()=>[l(U,{class:"pa-16 mt-1 card-memberPage"},{default:s(()=>[l(te,{onSubmit:X(t(T),["prevent"])},{default:s(()=>[n("div",null,[n("div",null,[e[8]||(e[8]=n("h1",{class:"font-weight-bold text-h4"},"球員資料",-1)),l(B,{thickness:2,opacity:"20",class:"mt-5"})])]),l(B,{class:"my-4"}),l(v,{justify:"center"},{default:s(()=>[l(o,{cols:"12",md:"12"},{default:s(()=>[l(U,{class:"pb-13 pt-8 pl-16 card-memberPage"},{default:s(()=>[e[11]||(e[11]=n("h3",{class:"font-weight-bold ml-n6",style:{"font-size":"1.3rem"}},"一般資訊",-1)),l(v,null,{default:s(()=>[l(o,{cols:"12",sm:"4"},{default:s(()=>[n("div",ue,[l(Y,{src:le,class:"avatar-img",cover:""}),n("input",{type:"file",ref_key:"fileInput",ref:M,onChange:$,style:{display:"none"},accept:"image/*"},null,544),l(u,{icon:"mdi-pencil",class:"btn btn-edit",onClick:j,rounded:"circle",size:"50"})])]),_:1}),l(o,{cols:"12",sm:"7"},{default:s(()=>[l(v,null,{default:s(()=>[l(o,{cols:"12",sm:"6",class:"mt-3"},{default:s(()=>[l(m,{label:"姓名",modelValue:t(V).value.value,"onUpdate:modelValue":e[0]||(e[0]=a=>t(V).value.value=a),"error-messages":t(V).errorMessage.value,variant:"outlined","hide-details":"",rules:[p.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1}),l(o,{cols:"12",sm:"6",class:"mt-3"},{default:s(()=>[l(E,{label:"性別",modelValue:t(_).value.value,"onUpdate:modelValue":e[1]||(e[1]=a=>t(_).value.value=a),"error-messages":t(_).errorMessage.value,variant:"outlined","hide-details":"",items:["女性","男性"],rules:[p.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1}),l(v,null,{default:s(()=>[l(o,{cols:"12",sm:"6"},{default:s(()=>[l(m,{label:"Email",modelValue:t(y).value.value,"onUpdate:modelValue":e[2]||(e[2]=a=>t(y).value.value=a),"error-messages":t(y).errorMessage.value,variant:"outlined","hide-details":"",rules:[p.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1}),l(o,{cols:"12",sm:"6"},{default:s(()=>[l(E,{label:"球技程度",modelValue:t(w).value.value,"onUpdate:modelValue":e[3]||(e[3]=a=>t(w).value.value=a),"error-messages":t(w).errorMessage.value,variant:"outlined","hide-details":"",items:["S 體保生","A 一般生校隊","B 一般生系隊","C 排球初階","D 排球初心者"],rules:[p.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1}),l(v,null,{default:s(()=>[l(o,{cols:"12",sm:"12"},{default:s(()=>[l(m,{label:"你的專屬球場勝利語",modelValue:t(P).value.value,"onUpdate:modelValue":e[4]||(e[4]=a=>t(P).value.value=a),"error-messages":t(P).errorMessage.value,variant:"outlined","hide-details":"",rules:[p.required],class:"neubrutalism"},null,8,["modelValue","error-messages","rules"])]),_:1})]),_:1}),n("div",ne,[l(f,{class:"mt-4 btn mr-3",color:"white",type:"cancel"},{default:s(()=>e[9]||(e[9]=[g("取消更新",-1)])),_:1,__:[9]}),l(f,{class:"mt-4 btn",type:"submit"},{default:s(()=>e[10]||(e[10]=[g("確認更新",-1)])),_:1,__:[10]})])]),_:1})]),_:1})]),_:1,__:[11]}),l(U,{class:"pa-10 rounded-lg mt-8 card-memberPage"},{default:s(()=>[e[15]||(e[15]=n("h3",{class:"font-weight-bold mb-4",style:{"font-size":"1.3rem"}},"機密資訊",-1)),l(v,null,{default:s(()=>[l(o,{cols:"12",sm:"4"},{default:s(()=>[l(m,{label:"Password",type:"password",modelValue:t(k).value.value,"onUpdate:modelValue":e[5]||(e[5]=a=>t(k).value.value=a),"error-messages":t(k).errorMessage.value,variant:"outlined","hide-details":"",readonly:"",class:"neubrutalism"},null,8,["modelValue","error-messages"]),l(f,{class:"mt-6 btn",variant:"outlined",type:"submit",block:""},{default:s(()=>e[12]||(e[12]=[g("更改密碼",-1)])),_:1,__:[12]})]),_:1}),l(o,{cols:"12",sm:"4"},{default:s(()=>[l(m,{label:"Line ID",modelValue:t(x).value.value,"onUpdate:modelValue":e[6]||(e[6]=a=>t(x).value.value=a),"error-messages":t(x).errorMessage.value,variant:"outlined","hide-details":"",readonly:"",class:"neubrutalism"},null,8,["modelValue","error-messages"]),l(f,{class:"mt-6 btn",type:"submit",variant:"outlined",block:""},{default:s(()=>e[13]||(e[13]=[g("更改 Line ID",-1)])),_:1,__:[13]})]),_:1}),l(o,{cols:"12",sm:"4"},{default:s(()=>[l(m,{label:"Google ID",modelValue:t(q).value.value,"onUpdate:modelValue":e[7]||(e[7]=a=>t(q).value.value=a),"error-messages":t(q).errorMessage.value,variant:"outlined","hide-details":"",readonly:"",class:"neubrutalism"},null,8,["modelValue","error-messages"]),l(f,{class:"mt-6 btn",type:"submit",variant:"outlined",block:""},{default:s(()=>e[14]||(e[14]=[g("更改 Google ID",-1)])),_:1,__:[14]})]),_:1})]),_:1})]),_:1,__:[15]})]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1}),e[16]||(e[16]=n("div",{class:"bottom-decoration d-flex justify-end pr-8",style:{position:"fixed",bottom:"0",width:"100%","z-index":"-1"}},null,-1))]),_:1,__:[16]}),t(N)?(h(),A("div",ie,[l(t(Z),{style:{height:"500px",width:"500px"},autoplay:"",loop:"",src:"https://lottie.host/4583ad3e-73e1-4f3a-83d5-048a1943aaa7/gPKIV1O45e.lottie"})])):W("",!0)],64)}}},we=H(de,[["__scopeId","data-v-ebf1cc94"]]);export{we as default};
