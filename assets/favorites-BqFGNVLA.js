import{_ as y,b as S,r as u,i as x,o as P,f as C,d as f,g as d,w as r,h as s,ar as l,J as n,as as v,k as g,j as F,F as I,t as B,aB as N,a7 as D,q as j,l as U,x as z,e as p}from"./index-DzXIfeuh.js";import{v as A}from"./venueService-Bfqci-4l.js";import{S as M,a as R}from"./navigation-Sl6wAroP.js";import{N as $}from"./navigation-CPxEz9Lp.js";/* empty css                                                                          */import{V as q,a as E}from"./VRow-D8c0znhA.js";import{V as J}from"./VContainer-DkZIsRd8.js";const L={class:"venueName"},T={__name:"favorites",setup(G){const _=[$];S();const b=u("@/assets/images/gabi hitting.jpg.jpg"),i=u([]),c=u({}),V=x(),h=async()=>{try{const{data:t}=await p.profile();if(!t||!t.user){console.log("API 回傳資料格式不正確或無使用者資料",t);return}c.value=t.user;const{data:e}=await A.getAvailable();if(e&&e.venues&&c.value.favoriteVenues){const o=new Set(c.value.favoriteVenues);i.value=e.venues.filter(a=>o.has(a._id)).map(a=>{const m=a.images&&a.images.length>0?a.images[0]:b.value;return{...a,imageUrl:m}})}}catch(t){console.error("使用者資料取得失敗:",t)}},w=async t=>{const e=[...i.value];i.value=i.value.filter(o=>o._id!==t);try{await p.updateFavoriteVenues({venueId:t})}catch(o){i.value=e,console.error("移除收藏失敗:",o),V({text:"無法移除收藏，請重新整理或稍後再試",snackbarProps:{color:"red"}})}};return P(()=>{h()}),(t,e)=>{const o=C("v-icon-btn");return d(),f(J,{class:"bg-dark"},{default:r(()=>[s(l,{class:"mt-1 pa-16 card-memberPage"},{default:r(()=>[n("div",null,[n("div",null,[e[0]||(e[0]=n("h1",{class:"font-weight-bold text-h4"},"我的收藏",-1)),s(v,{thickness:2,opacity:"20",class:"mt-5"})])]),s(v,{class:"my-4"}),s(q,{class:"mt-4 align-center"},{default:r(()=>[s(E,{cols:"12"},{default:r(()=>[e[1]||(e[1]=n("h2",{class:"mb-3 font-weight-bold",style:{"font-size":"1.7rem"}},"球場收藏",-1)),s(l,{class:"pa-8 card-memberPage",color:"#f1f1f1"},{default:r(()=>[s(g(M),{slidesPerView:"4",navigation:!0,modules:_,"space-between":5,class:"mySwiper"},{default:r(()=>[(d(!0),F(I,null,B(i.value,(a,m)=>(d(),f(g(R),{key:m},{default:r(()=>[s(l,{class:"card-memberPage card-favoriteVenues",width:"330",height:"250",to:`/venueSingle/${a._id}`},{default:r(()=>[s(N,{text:"移除收藏",location:"bottom"},{activator:r(({props:k})=>[s(o,D({venue:a},{ref_for:!0},k,{icon:"mdi-close",class:"btn btn-close",onClick:j(H=>w(a._id),["prevent","stop"])}),null,16,["venue","onClick"])]),_:2},1024),s(U,{src:a.imageUrl,class:"fill-height img-favoriteVenues",cover:""},null,8,["src"]),n("h2",L,z(a.name),1)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1})]),_:1}),e[2]||(e[2]=n("h2",{class:"mb-4 mt-8 font-weight-bold",style:{"font-size":"1.7rem"}},"商品收藏",-1)),s(l,{class:"pa-8 card-memberPage"})]),_:1,__:[1,2]})]),_:1})]),_:1})]),_:1})}}},ee=y(T,[["__scopeId","data-v-463d0d78"]]);export{ee as default};
