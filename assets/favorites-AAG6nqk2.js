import{_ as S,b as k,r as u,i as P,$ as x,e as C,d as f,o as d,w as r,f as t,aq as l,H as n,ar as v,h as g,g as F,F as I,p as N,aA as A,a6 as B,l as D,j,t as U,A as p}from"./index-C2Ki1pi2.js";import{v as $}from"./venueService-C_eS9flX.js";import{S as z,a as M}from"./navigation-DN2Y82LO.js";import{N as R}from"./navigation-Bf_bOUhZ.js";/* empty css                                                                          */import{V as q,a as E}from"./VRow-Dk5fHTbR.js";import{V as H}from"./VContainer-Du8D55aO.js";const L={class:"venueName"},T={__name:"favorites",setup(G){const _=[R];k();const b=u("@/assets/images/gabi hitting.jpg.jpg"),i=u([]),c=u({}),V=P(),h=async()=>{try{const{data:s}=await p.profile();if(!s||!s.user){console.log("API 回傳資料格式不正確或無使用者資料",s);return}c.value=s.user;const{data:e}=await $.getAvailable();if(e&&e.venues&&c.value.favoriteVenues){const o=new Set(c.value.favoriteVenues);i.value=e.venues.filter(a=>o.has(a._id)).map(a=>{const m=a.images&&a.images.length>0?a.images[0]:b.value;return{...a,imageUrl:m}})}}catch(s){console.error("使用者資料取得失敗:",s)}},w=async s=>{const e=[...i.value];i.value=i.value.filter(o=>o._id!==s);try{await p.updateFavoriteVenues({venueId:s})}catch(o){i.value=e,console.error("移除收藏失敗:",o),V({text:"無法移除收藏，請重新整理或稍後再試",snackbarProps:{color:"red"}})}};return x(()=>{h()}),(s,e)=>{const o=C("v-icon-btn");return d(),f(H,{class:"bg-dark"},{default:r(()=>[t(l,{class:"mt-1 pa-16 card-memberPage"},{default:r(()=>[n("div",null,[n("div",null,[e[0]||(e[0]=n("h1",{class:"font-weight-bold text-h4"},"我的收藏",-1)),t(v,{thickness:2,opacity:"20",class:"mt-5"})])]),t(v,{class:"my-4"}),t(q,{class:"mt-4 align-center"},{default:r(()=>[t(E,{cols:"12"},{default:r(()=>[e[1]||(e[1]=n("h2",{class:"mb-3 font-weight-bold",style:{"font-size":"1.7rem"}},"球場收藏",-1)),t(l,{class:"pa-8 card-memberPage",color:"#f1f1f1"},{default:r(()=>[t(g(z),{slidesPerView:"4",navigation:!0,modules:_,"space-between":5,class:"mySwiper"},{default:r(()=>[(d(!0),F(I,null,N(i.value,(a,m)=>(d(),f(g(M),{key:m},{default:r(()=>[t(l,{class:"card-memberPage card-favoriteVenues",width:"330",height:"250",to:`/venueSingle/${a._id}`},{default:r(()=>[t(A,{text:"移除收藏",location:"bottom"},{activator:r(({props:y})=>[t(o,B({venue:a},{ref_for:!0},y,{icon:"mdi-close",class:"btn btn-close",onClick:D(J=>w(a._id),["prevent","stop"])}),null,16,["venue","onClick"])]),_:2},1024),t(j,{src:a.imageUrl,class:"fill-height img-favoriteVenues",cover:""},null,8,["src"]),n("h2",L,U(a.name),1)]),_:2},1032,["to"])]),_:2},1024))),128))]),_:1})]),_:1}),e[2]||(e[2]=n("h2",{class:"mb-4 mt-8 font-weight-bold",style:{"font-size":"1.7rem"}},"商品收藏",-1)),t(l,{class:"pa-8 card-memberPage"})]),_:1,__:[1,2]})]),_:1})]),_:1})]),_:1})}}},ee=S(T,[["__scopeId","data-v-463d0d78"]]);export{ee as default};
